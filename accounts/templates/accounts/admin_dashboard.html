{% extends 'base.html' %}
{% block content %}
  <h2>Admin Dashboard</h2>
  <div style="display: flex; gap: 2em; margin-bottom: 2em;">
    <div><strong>Members:</strong><br>{{ member_count }}</div>
    <div><strong>Payments (Verified):</strong><br>₱{{ payment_total }}</div>
    <div><strong>Payments (Pending):</strong><br>{{ payment_pending }}</div>
    <div><strong>Announcements:</strong><br>{{ announcement_count }}</div>
  </div>
  <ul>
    <li><a href="{% url 'member_list' %}">Manage Members</a></li>
    <li><a href="{% url 'payments:payment_list' %}">Payments</a></li>
    <li><a href="{% url 'announcements:announcement_list' %}">Announcements</a></li>
    <li><a href="#">Analytics</a></li>
  </ul>
  <h3>Membership Growth (by Month)</h3>
  <table style="margin-bottom:1em;">
    <tr><th>Month</th><th>New Members</th></tr>
    {% for row in member_growth %}
      <tr><td>{{ row.month|date:'Y-m' }}</td><td>{{ row.count }}</td></tr>
    {% empty %}<tr><td colspan="2">No data</td></tr>{% endfor %}
  </table>
  <h3>Payment Trends (by Month)</h3>
  <table style="margin-bottom:1em;">
    <tr><th>Month</th><th>Total Payments</th></tr>
    {% for row in payment_trends %}
      <tr><td>{{ row.month|date:'Y-m' }}</td><td>₱{{ row.total }}</td></tr>
    {% empty %}<tr><td colspan="2">No data</td></tr>{% endfor %}
  </table>
  <h3>Announcement Engagement</h3>
  <table style="margin-bottom:1em;">
    <tr><th>Announcement</th><th>Read</th><th>Total Recipients</th></tr>
    {% for a in announcement_engagement %}
      <tr><td>{{ a.title }}</td><td>{{ a.read }}</td><td>{{ a.total }}</td></tr>
    {% empty %}<tr><td colspan="3">No data</td></tr>{% endfor %}
  </table>
  <h3>Most Active Scouts (by Payments)</h3>
  <table style="margin-bottom:1em;">
    <tr><th>Scout</th><th>Payments</th></tr>
    {% for scout in active_scouts %}
      <tr><td>{{ scout.username }}</td><td>{{ scout.payment_count }}</td></tr>
    {% empty %}<tr><td colspan="2">No data</td></tr>{% endfor %}
  </table>
{% endblock %} 